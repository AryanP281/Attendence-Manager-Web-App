//Database Creation
CREATE DATABASE AttendenceManager;

//Tables
CREATE TABLE UserCreds(email VARCHAR(255) PRIMARY KEY, password CHAR(60) NOT NULL);

CREATE TABLE Subject(id INT PRIMARY KEY, name VARCHAR(50) NOT NULL);

CREATE TABLE Takes(email VARCHAR(255), subjectId INT, totalLecs INT NOT NULL DEFAULT 0, attendedLecs INT NOT NULL DEFAULT 0, 
target INT NOT NULL DEFAULT 100, lastTimestamp TIMESTAMP DEFAULT NULL, PRIMARY KEY(email,SubjectId), 
FOREIGN KEY (email) REFERENCES UserCreds(email) ON DELETE CASCADE, 
FOREIGN KEY (subjectId) REFERENCES Subject(id) ON DELETE CASCADE);

CREATE TABLE Logs(email VARCHAR(255), subjectId INT, flag CHAR(1), timestamp TIMESTAMP, PRIMARY KEY(email,subjectId, timestamp), FOREIGN KEY (email) REFERENCES UserCreds(email) ON DELETE CASCADE, FOREIGN KEY (subjectId) REFERENCES Subject(id) ON DELETE CASCADE);

CREATE TABLE PasswordResetTokens(email VARCHAR(255) PRIMARY KEY, token CHAR(40) NOT NULL, FOREIGN KEY (email) REFERENCES UserCreds(email) ON DELETE CASCADE);

